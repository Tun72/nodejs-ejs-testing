<%- include("./includes/header.ejs") %>
<body>
  <%- include("./includes/nav.ejs") %>
  <div class="content">
    <div class="collumns">
      <% if(posts.length === 0 && isLogin) { %>
      <div class="collumn nothing">
        <h1>Nothing to see ?</h1>
        <p>Create a new post now !!!</p>
        <a href="/admin/create-post">Create a new post</a>
      </div>
      <% } else { %> <% for(let post of posts) { %>
      <div class="collumn">
        <div class="head">
          <!-- <span class="headline hl5"><%= post.title %></span> -->
          <p><span class="headline hl6"><%= post.title %></span></p>
        </div>

        <a
          href="<%=  `${ (user?._id?.toString() == post?.userId?._id?.toString())  ? '/admin/profile' : '/profile/'+ post?.userId?._id ?? '#' }` %>"
        >
          <div class="post-user">
            <div class="user-img">
              <% if(post?.userId?.isPremium) { %>
              <img src="<%=  '/' +  post?.userId?.profileImg %>" alt="" />
              <% } else { %>
              <i class="fa-solid fa-circle-user"></i>
              <% } %>
            </div>
            <div class="user-info">
              <span><%= post?.userId?.username ?? "Anonymous" %></span>
              <% if(post?.userId?.isPremium) { %>
              <span>
                Premium
                <span
                  class="animate__animated animate__infinite animate__headShake animate__delay-2s"
                  ><i class="fa-regular fa-star"></i
                ></span>
              </span>
              <% } else {%>
              <span>Free User</span>
              <% } %>
            </div>
          </div>
        </a>
        <figure class="figure">
          <img class="media" src="<%= post?.imgUrl %>" alt="" />
          <figcaption class="figcaption"><%= post?.createdAt %></figcaption>
        </figure>

        <p><%= `${post?.description.slice(1, 500)}` ?? "Anonymous" %></p>

        <p><a href="/post/<%= post._id %>">Read More</a></p>
      </div>
      <% } %> <% } %>
    </div>
  </div>

  <% if(posts.length !== 0) { %>
  <div class="next-page <%= `${hasNext && !hasPrev ? 'next' : '' }` %>">
    <% if(hasPrev) {%>
    <a href="/?page=<%= `${currentPage - 1}` %>">Prev</a>
    <%} %> <% if(hasNext) { %>
    <a href="/?page=<%= `${currentPage + 1}` %>">Next</a>
    <% } %>
  </div>
  <% } %>
</body>

<%- include("./includes/footer.ejs") %>
